<!doctype html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Selfie kiosk</title>
    <style>
    html,body{
        height:100%;
    }
    body{
        font: 3vw arial, sans-serif;
        color: white;
        margin:0;
        text-shadow: 0px 0px 5px black;
    }
    #shot{
        display:none;
    }
    #welcome{
        text-align:center;
        background-image: url(party.jpg);
        padding-top:15%;
        padding-bottom:auto;
        width:100%;
        height:100%;
        margin:0;
    }
    </style>
</head>
<body>
<div id="welcome">
    <h1 id="title_txt"></h1>
    <h2 id="touch_txt"></h2>
</div>
<div id="shot">
    <video width="640" height="400"></video>
    <button onclick="shot()">Shot</button>
    <button onclick="save()">Save</button>
    <canvas></canvas>
</div>
<script>
const STATE_WELCOME = 0;
var counter = 0;
var state = STATE_WELCOME;
var canvas = document.querySelector('canvas');
var video = document.querySelector('video');
var promise = navigator.mediaDevices.getUserMedia({video:true})
.then(function(stream) {
  /* use the stream */
  video.srcObject = stream;
  video.onloadedmetadata = function(e) {
    video.play();
  };
})
.catch(function(err) {
  /* handle the error */
  console.log(err.name + ": " + err.message);
});
function shot(){
	canvas.width = video.videoWidth;
	canvas.height = video.videoHeight;
	ctx = canvas.getContext('2d');
	ctx.drawImage(video, 0, 0);
    ctx.font = "30px Arial";
    ctx.fillStyle = "#fff";
    ctx.fillText("www.morrisons.hu",10,40);
	var image = canvas.toDataURL('image/jpeg', 0.8);
	//var File() = 
    // document.write(image);
    download("hello.jpg",image);
}
function download(filename, image) {
  var element = document.createElement('a');
  //element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
  element.setAttribute('href', image);
  element.setAttribute('download', filename);

  element.style.display = 'none';
  document.body.appendChild(element);
  element.click();
  document.body.removeChild(element);
}
function animation(){
    counter++;
    if(counter%2==0){
        f('title_txt').innerHTML = 'Selfie box';
        f('touch_txt').innerHTML = 'Touch the screen';
    }else{
        f('title_txt').innerHTML = 'Szelfi doboz';
        f('touch_txt').innerHTML = 'Éríntsd meg a képernyőt';
    }
}
function f(n){
    return document.getElementById(n);
}

setInterval(function(){animation()},1000);
// Start file download.
//download("hello.txt","This is the content of my file :)");

</script>
</body>
</html>